<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<title>Caro N×N – Trang riêng</title>

<style>
    body { font-family: Arial; text-align: center; background: #eef; }
    .board { display: grid; margin: 20px auto; gap: 4px; }
    .cell {
        width: 35px; height: 35px;
        background: white; border: 1px solid black;
        display: flex; justify-content: center; align-items: center;
        font-size: 22px; cursor: pointer; user-select: none;
    }

    #canvas { border: 2px solid black; margin-top: 20px; }
</style>
</head>
<body>

<h1>Game Caro N×N – Trang riêng</h1>

<input id="sizeN" type="number" placeholder="Nhập N" />
<button onclick="start()">Tạo bàn N×N</button>

<div id="boardArea"></div>

<h2>Canvas</h2>
<canvas id="canvas" width="400" height="400"></canvas>

<script>
let N = 0;
let board = [];
let turn = "X";

function start() {
    N = parseInt(document.getElementById("sizeN").value);
    if (!N || N < 3) return alert("N phải ≥ 3");

    const area = document.getElementById("boardArea");
    area.innerHTML = "";

    const bd = document.createElement("div");
    bd.className = "board";
    bd.style.gridTemplateColumns = `repeat(${N}, 35px)`;
    area.appendChild(bd);

    board = Array.from({ length: N }, () => Array(N).fill(""));
    turn = "X";

    for (let i = 0; i < N; i++)
        for (let j = 0; j < N; j++) {
            const c = document.createElement("div");
            c.className = "cell";
            c.onclick = () => click(i,j,c);
            bd.appendChild(c);
        }

    drawCanvas();
}

function click(i, j, cell) {
    if (board[i][j] !== "") return;

    board[i][j] = turn;
    cell.textContent = turn;

    if (check(turn)) {
        alert(turn + " thắng!");
        return;
    }

    turn = turn === "X" ? "O" : "X";
}

function check(p) {
    for (let i = 0; i < N; i++)
        for (let j = 0; j < N - 2; j++)
            if (board[i][j] === p && board[i][j+1] === p && board[i][j+2] === p)
                return true;

    for (let j = 0; j < N; j++)
        for (let i = 0; i < N - 2; i++)
            if (board[i][j] === p && board[i+1][j] === p && board[i+2][j] === p)
                return true;

    for (let i = 0; i < N - 2; i++)
        for (let j = 0; j < N - 2; j++)
            if (board[i][j] === p && board[i+1][j+1] === p && board[i+2][j+2] === p)
                return true;

    for (let i = 0; i < N - 2; i++)
        for (let j = 2; j < N; j++)
            if (board[i][j] === p && board[i+1][j-1] === p && board[i+2][j-2] === p)
                return true;

    return false;
}

// Canvas vẽ ô caro
function drawCanvas() {
    const cv = document.getElementById("canvas");
    const ctx = cv.getContext("2d");

    ctx.clearRect(0,0,400,400);
    ctx.strokeStyle = "black";

    const size = 20;
    for (let i = 0; i <= 400; i += size) {
        ctx.beginPath();
        ctx.moveTo(i, 0);
        ctx.lineTo(i, 400);
        ctx.stroke();

        ctx.beginPath();
        ctx.moveTo(0, i);
        ctx.lineTo(400, i);
        ctx.stroke();
    }
}
</script>

</body>
</html>
